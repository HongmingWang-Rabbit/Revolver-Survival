var D=Object.defineProperty;var _=(t,n,e)=>n in t?D(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var A=(t,n,e)=>_(t,typeof n!="symbol"?n+"":n,e);import{y,z as b,A as d}from"./CBrW-7S6.js";const N=1e6;function Y(t){return Math.round(t*N)}function c(t){return t/N}function W(){if(typeof window>"u")return null;const t=new URLSearchParams(window.location.search),n=t.get("sessionID"),e=t.get("rgs_url")||t.get("rgsUrl"),o=t.get("lang")||t.get("language")||"en",a=t.get("currency")||"USD";if(!n||!e)return console.warn("RGS: Missing required URL parameters (sessionID, rgs_url)"),null;const s=e.startsWith("http")?e:`https://${e}`;return{sessionID:n,rgsUrl:s,language:o,currency:a}}class S extends Error{constructor(e,o,a){super(o);A(this,"code");A(this,"httpStatus");this.name="RGSError",this.code=e,this.httpStatus=a}isInvalidSession(){return this.code==="ERR_IS"}isInsufficientBalance(){return this.code==="ERR_IPB"}isGamblingLimitExceeded(){return this.code==="ERR_GLE"}}class z{constructor(){A(this,"config",null);A(this,"initialized",!1)}init(){return this.config=W(),this.initialized=this.config!==null,this.initialized}isInitialized(){return this.initialized&&this.config!==null}getConfig(){return this.config}async request(n,e){if(!this.config)throw new Error("RGS client not initialized");const o=`${this.config.rgsUrl}${n}`;try{const a=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionID:this.config.sessionID,...e})});if(!a.ok){const s=await a.json().catch(()=>({}));throw new S(s.code||"ERR_UNKNOWN",s.message||`HTTP ${a.status}`,a.status)}return await a.json()}catch(a){throw a instanceof S?a:new S("ERR_NETWORK",`Network error: ${a}`,0)}}async authenticate(){if(!this.config)throw new Error("RGS client not initialized");return this.request("/wallet/authenticate",{language:this.config.language,currency:this.config.currency})}async getBalance(){return(await this.request("/wallet/balance",{})).balance}async play(n,e){return this.request("/wallet/play",{amount:Y(n),mode:e})}async endRound(n){return this.request("/wallet/end-round",{roundId:n})}}const B=new z,x=6,T=[{name:"mode_1_bullet",bullets:1,survivalRate:.8333,multiplier:1.17,displayName:"1 Bullet"},{name:"mode_2_bullet",bullets:2,survivalRate:.6667,multiplier:1.46,displayName:"2 Bullets"},{name:"mode_3_bullet",bullets:3,survivalRate:.5,multiplier:1.95,displayName:"3 Bullets"},{name:"mode_4_bullet",bullets:4,survivalRate:.3333,multiplier:2.93,displayName:"4 Bullets"},{name:"mode_5_bullet",bullets:5,survivalRate:.1667,multiplier:5.86,displayName:"5 Bullets"}],R={initialized:!0,loading:!1,error:null,minBet:.01,maxBet:1e3,stepBet:.01,defaultBet:1,betLevels:[{amount:.1},{amount:.5},{amount:1,default:!0},{amount:5},{amount:10},{amount:50},{amount:100}],currency:"USD",isDemo:!0},v={gameState:"idle",selectedBullets:1,betAmount:1,currentPot:0,lastResult:null,roundHistory:[]},H={initialized:!1,loading:!1,error:null,minBet:.01,maxBet:1e3,stepBet:.01,defaultBet:1,betLevels:[],currency:"USD",isDemo:!0},l=b(0),r=b(v),w=b(!1),E=b(!1),m=b(H),L=y(r,t=>T.find(n=>n.bullets===t.selectedBullets)||T[0]),j=y([l,r,m],([t,n,e])=>e.initialized&&n.gameState==="idle"&&n.betAmount>=e.minBet&&n.betAmount<=e.maxBet&&n.betAmount<=t),K=y([r,w],([t,n])=>(t.gameState==="betting"||t.gameState==="continue")&&!n),F=y([r,L],([t,n])=>(t.gameState==="continue"?t.currentPot:t.betAmount)*n.multiplier);y(m,t=>t.minBet);y(m,t=>t.maxBet);async function J(){var n;if(m.update(e=>({...e,loading:!0,error:null})),!B.init())return m.set(R),l.set(100),r.update(e=>({...e,betAmount:R.defaultBet})),!0;try{const e=await B.authenticate(),o=(e.config.betLevels||[]).map(u=>({amount:c(u),default:u===e.config.defaultBetLevel})),a=e.config.defaultBetLevel?c(e.config.defaultBetLevel):((n=o[0])==null?void 0:n.amount)||c(e.config.minBet),s={initialized:!0,loading:!1,error:null,minBet:c(e.config.minBet),maxBet:c(e.config.maxBet),stepBet:c(e.config.stepBet||e.config.minBet),defaultBet:a,betLevels:o,currency:e.balance.currency,isDemo:!1};if(m.set(s),l.set(c(e.balance.amount)),r.update(u=>({...u,betAmount:s.defaultBet})),e.round)try{const u=await B.endRound(e.round.roundID);l.set(c(u.balance.amount))}catch(u){console.warn("RGS: Failed to end active round",u)}return!0}catch(e){const o=e instanceof S?`${e.code}: ${e.message}`:String(e);return m.update(a=>({...a,loading:!1,error:o,initialized:!1})),m.set({...R,error:o}),l.set(100),r.update(a=>({...a,betAmount:R.defaultBet})),!1}}function X(t){const n=d(m),e=Math.round(t/n.stepBet)*n.stepBet,o=Math.max(n.minBet,Math.min(n.maxBet,e));r.update(a=>({...a,betAmount:Math.round(o*100)/100}))}function Q(t){t>=1&&t<=5&&r.update(n=>({...n,selectedBullets:t}))}async function V(){const t=d(r),n=d(l),e=d(m);return t.betAmount>n||t.betAmount<e.minBet||t.betAmount>e.maxBet?!1:(e.isDemo&&l.update(o=>o-t.betAmount),r.update(o=>({...o,gameState:"betting",currentPot:t.betAmount})),!0)}function Z(){r.update(t=>({...t,gameState:"continue"})),E.set(!1)}async function $(){var o,a;const t=d(r),n=d(L),e=d(m);w.set(!0),r.update(s=>({...s,gameState:"spinning"}));try{let s;if(e.isDemo){await new Promise(i=>setTimeout(i,1500));const f=Math.random()<n.survivalRate;s={id:Date.now(),events:[{type:"spin",chamber:Math.floor(Math.random()*x)+1,result:f?"empty":"live",bullets_loaded:n.bullets},{type:"outcome",status:f?"survived":"death",message:f?"Click! You survived!":"BANG! Game over."}],payoutMultiplier:f?Math.round(n.multiplier*100):0,balance:d(l)}}else{const g=t.gameState==="continue"?Math.round(t.currentPot*100)/100:t.betAmount;l.update(p=>p-g);let f;try{f=await B.play(g,n.name)}catch(p){if(p instanceof S&&p.message.includes("active bet"))try{const O=await B.endRound();l.set(c(O.balance.amount)),f=await B.play(g,n.name)}catch{throw p}else throw p}l.set(c(((o=f.balance)==null?void 0:o.amount)||0));const i=f.round;s={id:(i==null?void 0:i.roundID)||(i==null?void 0:i.id)||Date.now(),events:(i==null?void 0:i.events)||[],payoutMultiplier:(i==null?void 0:i.payoutMultiplier)||0,balance:c(((a=f.balance)==null?void 0:a.amount)||0)},r.update(p=>({...p,currentRoundId:String((i==null?void 0:i.roundID)||(i==null?void 0:i.id)||"")}))}const u=s.payoutMultiplier>0,I=s.payoutMultiplier>10?s.payoutMultiplier/100:s.payoutMultiplier,G=t.gameState==="continue"?t.currentPot:t.betAmount,U=u?Math.round(G*I*100)/100:0;return w.set(!1),E.set(!0),r.update(g=>({...g,gameState:"result",currentPot:U,lastResult:s,roundHistory:[...g.roundHistory,s]})),u||setTimeout(()=>{P()},3e3),s}catch(s){throw console.error("Spin error:",s),w.set(!1),!e.isDemo&&t.gameState!=="continue"&&l.update(u=>u+t.betAmount),r.update(u=>({...u,gameState:"idle"})),s}}async function tt(){const t=d(r);if(d(m).isDemo)return l.update(e=>e+t.currentPot),P(),!0;try{const e=await B.endRound(t.currentRoundId);return l.set(c(e.balance.amount)),P(),!0}catch(e){throw console.error("Cash out error:",e),P(),e}}function P(){const t=d(r);r.set({...v,betAmount:t.betAmount,selectedBullets:t.selectedBullets}),E.set(!1)}const M=b(!1);function et(){if(typeof window>"u")return;const t=new URLSearchParams(window.location.search),n=t.get("social")||t.get("socialCasino");(n==="true"||n==="1")&&M.set(!0)}const C={bet:"play",Bet:"Play",BET:"PLAY",bets:"plays",Bets:"Plays",BETS:"PLAYS",betting:"playing",Betting:"Playing",BETTING:"PLAYING","Place your bet":"Place your play","PLACE BET":"PLAY NOW","BET PLACED":"PLAYING","BET AMOUNT":"PLAY AMOUNT","total bet":"total play","Total Bet":"Total Play","TOTAL BET":"TOTAL PLAY",cash:"coins",Cash:"Coins",CASH:"COINS","CASH OUT":"COLLECT","Cash Out":"Collect","cash out":"collect",money:"coins",Money:"Coins",MONEY:"COINS",currency:"token",Currency:"Token",CURRENCY:"TOKEN",gamble:"play",Gamble:"Play",GAMBLE:"PLAY",wager:"play",Wager:"Play",WAGER:"PLAY",deposit:"get coins",Deposit:"Get Coins",DEPOSIT:"GET COINS",withdraw:"redeem",Withdraw:"Redeem",WITHDRAW:"REDEEM",credit:"coins",Credit:"Coins",CREDIT:"COINS","pay out":"win","Pay Out":"Win","PAY OUT":"WIN","paid out":"won","Paid Out":"Won","PAID OUT":"WON","pays out":"wins","Pays Out":"Wins","PAYS OUT":"WINS","buy bonus":"get bonus","Buy Bonus":"Get Bonus","BUY BONUS":"GET BONUS","bonus buy":"bonus","Bonus Buy":"Bonus","BONUS BUY":"BONUS"};function h(t,n){return y(M,e=>e?n||(C[t]?C[t]:t):t)}const nt={placeBet:h("Place your bet","Place your play"),betAmount:h("BET AMOUNT","PLAY AMOUNT"),placeBetBtn:h("PLACE BET","PLAY NOW"),betPlaced:h("BET PLACED","PLAYING"),cashOut:h("CASH OUT","COLLECT"),balance:h("BALANCE","COINS")};export{T as G,nt as T,J as a,m as b,j as c,l as d,X as e,w as f,E as g,K as h,et as i,F as j,$ as k,tt as l,Z as m,V as p,r,Q as s};
